<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard | Karibu Groceries</title>

    <!-- Bootstrap -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <!-- Main Styles -->
    <link rel="stylesheet" href="./css/main.css" />
  </head>
  <body>
    <!-- navigation -->
    <nav class="top-nav">
      <div class="container">
        <a href="./dashboard.html" class="nav-brand">
          Karibu <span>Groceries</span>
        </a>

        <div class="nav-links d-none d-md-flex">
          <a href="./dashboard.html" class="nav-link active">Dashboard</a>
          <a
            href="./pages/sales-history.html"
            class="nav-link role-sales role-manager"
            >Sales</a
          >
          <a href="./pages/stock.html" class="nav-link role-manager">Stock</a>
          <a href="./pages/procurement.html" class="nav-link role-manager"
            >Procurement</a
          >
          <a
            href="./pages/director/dashboard.html"
            class="nav-link role-director"
            >Director Panel</a
          >
          <a href="./pages/director/users.html" class="nav-link role-director"
            >Users</a
          >
        </div>

        <div class="nav-actions">
          <div class="profile-menu">
            <button class="profile-trigger" id="profileToggle">
              <div class="profile-avatar" id="profileAvatar">U</div>
              <span id="navUserName">User</span>
            </button>

            <div class="profile-dropdown" id="profileDropdown">
              <div class="profile-dropdown-header">
                <strong id="dropdownUserName">User</strong>
                <small id="dropdownUserRole">Role</small>
              </div>
              <button id="logoutBtn">Logout</button>
            </div>
          </div>
        </div>
      </div>
    </nav>

    <!-- Page Header-->
    <header class="dashboard-header">
      <div class="container">
        <h4 class="mb-1 fw-bold">Dashboard Overview</h4>
        <p class="page-subtitle">
          Branch: <strong id="userBranch">—</strong> •
          <span id="currentDate"></span>
        </p>
      </div>
    </header>

    <!-- Main page content -->
    <main class="container py-5">
      <!-- directors Snapshot -->
      <section class="role-director">
        <h4 class="section-title mb-3">Company Snapshot</h4>
        <div class="row g-4">
          <div class="col-md-4">
            <div class="summary-card highlight">
              <h5>Total Cash Sales</h5>
              <p class="summary-amount" id="dirCashTotal">UGX 0</p>
            </div>
          </div>
          <div class="col-md-4">
            <div class="summary-card">
              <h5>Outstanding Credit</h5>
              <p class="summary-amount" id="dirCreditTotal">UGX 0</p>
            </div>
          </div>
          <div class="col-md-4">
            <div class="summary-card">
              <h5>Total Stock (All Branches)</h5>
              <p class="summary-amount" id="dirStockTotal">0 KG</p>
            </div>
          </div>
        </div>
      </section>

      <!-- operational performance -->
      <section class="role-manager role-sales">
        <h4 class="section-title mb-3">Today’s Performance</h4>
        <div class="row g-4">
          <div class="col-md-3">
            <div class="summary-card highlight">
              <h5>Cash Sales Today</h5>
              <p class="summary-amount" id="cashToday">UGX 0</p>
            </div>
          </div>
          <div class="col-md-3 role-manager">
            <div class="summary-card">
              <h5>Outstanding Credit</h5>
              <p class="summary-amount" id="creditTotal">UGX 0</p>
            </div>
          </div>
          <div class="col-md-3 role-manager">
            <div class="summary-card">
              <h5>Available Stock</h5>
              <p class="summary-amount" id="stockTotal">0 KG</p>
            </div>
          </div>
          <div class="col-md-3">
            <div class="summary-card">
              <h5>Transactions Today</h5>
              <p class="summary-amount" id="todayTx">0</p>
            </div>
          </div>
        </div>
      </section>

      <!-- Quick actions section -->
      <section class="role-manager role-sales">
        <h4 class="section-title mb-3">Quick Actions</h4>
        <div class="row g-3">
          <div class="col-md-3">
            <a
              href="./pages/cash-sale.html"
              class="btn btn-primary w-100 btn-lg"
            >
              Record Cash Sale
            </a>
          </div>
          <div class="col-md-3">
            <a
              href="./pages/credit-sale.html"
              class="btn btn-outline-primary w-100 btn-lg"
            >
              Record Credit Sale
            </a>
          </div>
          <div class="col-md-3 role-manager">
            <a
              href="./pages/procurement.html"
              class="btn btn-outline-secondary w-100 btn-lg"
            >
              Record Procurement
            </a>
          </div>
          <div class="col-md-3 role-manager">
            <a
              href="./pages/stock.html"
              class="btn btn-outline-secondary w-100 btn-lg"
            >
              View Stock
            </a>
          </div>
        </div>
      </section>

      <!-- INSIGHTS -->
      <section>
        <div class="row g-4">
          <div class="col-lg-6">
            <div class="card">
              <div class="card-body">
                <h4 class="section-title mb-3">Top Selling Produce</h4>
                <div id="topSellingContainer">
                  <div class="text-muted text-center py-4">
                    No sales recorded yet.
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="col-lg-6">
            <div class="card">
              <div class="card-body">
                <h4 class="section-title mb-3">Low Stock Alerts</h4>
                <div id="lowStockList">
                  <div class="text-muted text-center py-4">
                    All stock levels are healthy.
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- SALES TREND -->
        <div class="row g-4 mt-4">
          <div class="col-12">
            <div class="card">
              <div
                class="card-header d-flex justify-content-between align-items-center py-3"
                data-bs-toggle="collapse"
                data-bs-target="#salesTrendBody"
                style="cursor: pointer"
              >
                <h4 class="section-title mb-0">Sales Trend</h4>
                <div>
                  <button
                    class="btn btn-outline-secondary btn-sm me-2"
                    id="togglePeriodBtn"
                  >
                    Last 7 Days
                  </button>
                  <button
                    class="btn btn-outline-primary btn-sm"
                    id="exportTrendBtn"
                  >
                    Export CSV
                  </button>
                </div>
              </div>
              <div class="collapse show" id="salesTrendBody">
                <div class="card-body pt-0">
                  <small class="text-muted d-block mb-3" id="periodLabel"
                    >Last 7 Days</small
                  >
                  <div id="salesTrendContainer"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>

    <!-- SCRIPTS -->
    <script src="./js/auth.js"></script>
    <script src="./js/dashboard.js"></script>
  </body>
</html>
